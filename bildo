#!/usr/bin/env bash

PKG_LIST=$(ls pkg/src | tr " " "\n")

case "${1:2}" in
	"version")
		echo "bildo 0.01.1"
		;;
	"help")
		echo "./bildo [arg]"
		echo ""
		echo "arguments:"
		echo "--update:  git pull all dirs in pkg/src"
		echo "--upgrade: compile all packages from pkg/repo build scripts"
		echo ""
		;;
	"list")
		echo "$PKG_LIST"
		;;
	"update")
		echo -n "updating bildo repo..."
		git pull > /dev/null 2>&1
		echo " done"
		echo -n "updating projects  ..."
		for l in $PKG_LIST; do
			cd pkg/src/"$l"
			git pull > /dev/null 2>&1
			cd ../../..
		done
		echo " done"
		;;
	"upgrade")
		for l in $PKG_LIST; do
			bash pkg/repo/"${l}".sh
		done
		;;
	*)
		echo "unrecognized command"
		;;
esac
